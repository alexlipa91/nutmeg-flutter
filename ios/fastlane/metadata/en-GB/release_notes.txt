Add more user stats and a bunch of minor fixes
